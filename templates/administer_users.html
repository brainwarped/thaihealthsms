{% extends 'base.html' %}
{% load helper %}

{% block html_head %}
<script type="text/javascript">
	$(document).ready(function() {
		$('.user-delete').click(function(e) {
			e.preventDefault()
			if(window.confirm("Confirm?")) {
				var this_row = $(this)
				$.getJSON($(this).attr('href'), {}, function(resp) {
					this_row.parent().parent().remove();
				})
			}
		})
	})
	
</script>
{% endblock %}

{% block body_title %}
<div class="ss_header">
<div class="container">
	<div class="title"><span>จัดการระบบ</span> ผู้ใช้ระบบ</div>
</div>
</div>
<div class="ss_tab_navi">
	<div class="tabs">
		<ul>
			<li><a href="{% url view_administer_organization %}">โครงสร้างองค์กร</a></li>
			<li class="selected">ผู้ใช้ระบบ</li>
		</ul>
		<div class="clear"></div>
	</div>
</div>
{% endblock %}

{% block body_content %}
<div class="ss_control_panel">
	<ul>
		<li><img src="{{MEDIA_URL}}/images/icon_create.png" class="icon"/><a href="{% url view_administer_users_add %}">เพิ่มผู้ใช้</a></li>
	</ul>
	<div class="clear"></div>
</div>

<div class="user_management_page">
	<table>
		<tr>
			<th></th>
			<th class="fullname">ชื่อ-นามสกุล</th>
			<th class="sector">สังกัดสำนัก</th>
			<th class="role">ตำแหน่ง</th>
			<th class="projects">หน่วยงานที่รับผิดชอบ</th>
			<th class="status">สถานะผู้ใช้</th>
		</tr>
		{% for user in users %}
	    <tr>
			<td class="controls">
				<a href="{% url view_administer_users_edit user.id %}" title="แก้ไขข้อมูลผู้ใช้"><img src="{{MEDIA_URL}}/images/icon_edit.png" class="icon" /></a>
			</td>
			<td class="fullname">{{user.get_profile.first_name}} {{user.get_profile.last_name}}</td>
			<td class="sector">{{user.get_profile.sector.ref_no}}</td>
			<td class="role">{{user.roles}}</td>
			<td class="projects">{{user.projects}}</td>
			<td class="status"></td>
		</tr>
		{% endfor %}
	</table>
</div>
{% endblock %}
